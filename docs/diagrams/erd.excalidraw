{
  "type": "excalidraw",
  "version": 2,
  "source": "xentri-architecture",
  "elements": [
    {
      "id": "title",
      "type": "text",
      "x": 400,
      "y": 20,
      "width": 400,
      "height": 40,
      "text": "Xentri Entity-Relationship Diagram",
      "fontSize": 28,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e293b"
    },
    {
      "id": "subtitle",
      "type": "text",
      "x": 400,
      "y": 55,
      "width": 300,
      "height": 20,
      "text": "Multi-tenant Database Schema with RLS",
      "fontSize": 14,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#64748b"
    },
    {
      "id": "users-box",
      "type": "rectangle",
      "x": 50,
      "y": 100,
      "width": 200,
      "height": 180,
      "strokeColor": "#7c3aed",
      "backgroundColor": "#ede9fe",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3, "value": 8 }
    },
    {
      "id": "users-title",
      "type": "text",
      "x": 60,
      "y": 110,
      "width": 180,
      "height": 24,
      "text": "users",
      "fontSize": 18,
      "fontFamily": 3,
      "textAlign": "center",
      "strokeColor": "#4c1d95"
    },
    {
      "id": "users-fields",
      "type": "text",
      "x": 60,
      "y": 140,
      "width": 180,
      "height": 130,
      "text": "ğŸ”‘ id: uuid (PK)\nğŸ“§ email: varchar\nğŸ‘¤ full_name: varchar\nğŸ–¼ï¸ avatar_url: varchar\nğŸ”’ auth_provider: enum\nğŸ“… created_at: timestamp\nğŸ“… updated_at: timestamp",
      "fontSize": 12,
      "fontFamily": 3,
      "textAlign": "left",
      "strokeColor": "#4c1d95"
    },
    {
      "id": "orgs-box",
      "type": "rectangle",
      "x": 350,
      "y": 100,
      "width": 200,
      "height": 180,
      "strokeColor": "#7c3aed",
      "backgroundColor": "#ede9fe",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3, "value": 8 }
    },
    {
      "id": "orgs-title",
      "type": "text",
      "x": 360,
      "y": 110,
      "width": 180,
      "height": 24,
      "text": "organizations",
      "fontSize": 18,
      "fontFamily": 3,
      "textAlign": "center",
      "strokeColor": "#4c1d95"
    },
    {
      "id": "orgs-fields",
      "type": "text",
      "x": 360,
      "y": 140,
      "width": 180,
      "height": 130,
      "text": "ğŸ”‘ id: uuid (PK)\nğŸ¢ name: varchar\nğŸŒ slug: varchar (unique)\nğŸ“‹ plan_id: varchar\nâš™ï¸ settings: jsonb\nğŸ“… created_at: timestamp\nğŸ“… updated_at: timestamp",
      "fontSize": 12,
      "fontFamily": 3,
      "textAlign": "left",
      "strokeColor": "#4c1d95"
    },
    {
      "id": "members-box",
      "type": "rectangle",
      "x": 200,
      "y": 320,
      "width": 200,
      "height": 140,
      "strokeColor": "#7c3aed",
      "backgroundColor": "#ede9fe",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3, "value": 8 }
    },
    {
      "id": "members-title",
      "type": "text",
      "x": 210,
      "y": 330,
      "width": 180,
      "height": 24,
      "text": "org_members",
      "fontSize": 18,
      "fontFamily": 3,
      "textAlign": "center",
      "strokeColor": "#4c1d95"
    },
    {
      "id": "members-fields",
      "type": "text",
      "x": 210,
      "y": 360,
      "width": 180,
      "height": 90,
      "text": "ğŸ”— user_id: uuid (FK)\nğŸ”— org_id: uuid (FK)\nğŸ‘‘ role: enum\nğŸ“… joined_at: timestamp\n(PK: user_id + org_id)",
      "fontSize": 12,
      "fontFamily": 3,
      "textAlign": "left",
      "strokeColor": "#4c1d95"
    },
    {
      "id": "events-box",
      "type": "rectangle",
      "x": 650,
      "y": 100,
      "width": 220,
      "height": 200,
      "strokeColor": "#f59e0b",
      "backgroundColor": "#fef3c7",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3, "value": 8 }
    },
    {
      "id": "events-title",
      "type": "text",
      "x": 660,
      "y": 110,
      "width": 200,
      "height": 24,
      "text": "system_events",
      "fontSize": 18,
      "fontFamily": 3,
      "textAlign": "center",
      "strokeColor": "#92400e"
    },
    {
      "id": "events-fields",
      "type": "text",
      "x": 660,
      "y": 140,
      "width": 200,
      "height": 150,
      "text": "ğŸ”‘ id: uuid (PK)\nğŸ”— org_id: uuid (FK, RLS)\nğŸ“Œ type: varchar\nğŸ“… occurred_at: timestamp\nğŸ‘¤ actor_type: enum\nğŸ‘¤ actor_id: uuid\nğŸ“¦ payload: jsonb\nğŸ”„ correlation_id: uuid",
      "fontSize": 12,
      "fontFamily": 3,
      "textAlign": "left",
      "strokeColor": "#92400e"
    },
    {
      "id": "events-note",
      "type": "text",
      "x": 660,
      "y": 285,
      "width": 200,
      "height": 14,
      "text": "âš ï¸ APPEND-ONLY",
      "fontSize": 11,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#92400e"
    },
    {
      "id": "briefs-box",
      "type": "rectangle",
      "x": 50,
      "y": 500,
      "width": 200,
      "height": 180,
      "strokeColor": "#0284c7",
      "backgroundColor": "#e0f2fe",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3, "value": 8 }
    },
    {
      "id": "briefs-title",
      "type": "text",
      "x": 60,
      "y": 510,
      "width": 180,
      "height": 24,
      "text": "briefs",
      "fontSize": 18,
      "fontFamily": 3,
      "textAlign": "center",
      "strokeColor": "#0c4a6e"
    },
    {
      "id": "briefs-fields",
      "type": "text",
      "x": 60,
      "y": 540,
      "width": 180,
      "height": 130,
      "text": "ğŸ”‘ id: uuid (PK)\nğŸ”— org_id: uuid (FK, RLS)\nğŸ“Š status: enum\nğŸ§¬ identity: jsonb\nğŸ¯ offerings: jsonb\nğŸ“ˆ goals: jsonb\nğŸ“… created_at: timestamp\nğŸ“… updated_at: timestamp",
      "fontSize": 12,
      "fontFamily": 3,
      "textAlign": "left",
      "strokeColor": "#0c4a6e"
    },
    {
      "id": "sites-box",
      "type": "rectangle",
      "x": 300,
      "y": 500,
      "width": 200,
      "height": 160,
      "strokeColor": "#0284c7",
      "backgroundColor": "#e0f2fe",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3, "value": 8 }
    },
    {
      "id": "sites-title",
      "type": "text",
      "x": 310,
      "y": 510,
      "width": 180,
      "height": 24,
      "text": "sites",
      "fontSize": 18,
      "fontFamily": 3,
      "textAlign": "center",
      "strokeColor": "#0c4a6e"
    },
    {
      "id": "sites-fields",
      "type": "text",
      "x": 310,
      "y": 540,
      "width": 180,
      "height": 110,
      "text": "ğŸ”‘ id: uuid (PK)\nğŸ”— org_id: uuid (FK, RLS)\nğŸŒ domain: varchar\nğŸ“Š status: enum\nğŸ¨ theme: jsonb\nğŸ“… published_at: timestamp\nğŸ“… updated_at: timestamp",
      "fontSize": 12,
      "fontFamily": 3,
      "textAlign": "left",
      "strokeColor": "#0c4a6e"
    },
    {
      "id": "pages-box",
      "type": "rectangle",
      "x": 300,
      "y": 700,
      "width": 200,
      "height": 160,
      "strokeColor": "#0284c7",
      "backgroundColor": "#e0f2fe",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3, "value": 8 }
    },
    {
      "id": "pages-title",
      "type": "text",
      "x": 310,
      "y": 710,
      "width": 180,
      "height": 24,
      "text": "pages",
      "fontSize": 18,
      "fontFamily": 3,
      "textAlign": "center",
      "strokeColor": "#0c4a6e"
    },
    {
      "id": "pages-fields",
      "type": "text",
      "x": 310,
      "y": 740,
      "width": 180,
      "height": 110,
      "text": "ğŸ”‘ id: uuid (PK)\nğŸ”— site_id: uuid (FK)\nğŸ”— org_id: uuid (FK, RLS)\nğŸ“„ slug: varchar\nğŸ“ content: jsonb\nğŸ“Š status: enum\nğŸ“… updated_at: timestamp",
      "fontSize": 12,
      "fontFamily": 3,
      "textAlign": "left",
      "strokeColor": "#0c4a6e"
    },
    {
      "id": "leads-box",
      "type": "rectangle",
      "x": 550,
      "y": 500,
      "width": 200,
      "height": 180,
      "strokeColor": "#0284c7",
      "backgroundColor": "#e0f2fe",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3, "value": 8 }
    },
    {
      "id": "leads-title",
      "type": "text",
      "x": 560,
      "y": 510,
      "width": 180,
      "height": 24,
      "text": "leads",
      "fontSize": 18,
      "fontFamily": 3,
      "textAlign": "center",
      "strokeColor": "#0c4a6e"
    },
    {
      "id": "leads-fields",
      "type": "text",
      "x": 560,
      "y": 540,
      "width": 180,
      "height": 130,
      "text": "ğŸ”‘ id: uuid (PK)\nğŸ”— org_id: uuid (FK, RLS)\nğŸ“§ email: varchar\nğŸ‘¤ name: varchar\nğŸ“Š status: enum\nğŸ·ï¸ source: varchar\nğŸ“… captured_at: timestamp\nğŸ“… updated_at: timestamp",
      "fontSize": 12,
      "fontFamily": 3,
      "textAlign": "left",
      "strokeColor": "#0c4a6e"
    },
    {
      "id": "followups-box",
      "type": "rectangle",
      "x": 550,
      "y": 720,
      "width": 200,
      "height": 140,
      "strokeColor": "#0284c7",
      "backgroundColor": "#e0f2fe",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3, "value": 8 }
    },
    {
      "id": "followups-title",
      "type": "text",
      "x": 560,
      "y": 730,
      "width": 180,
      "height": 24,
      "text": "follow_ups",
      "fontSize": 18,
      "fontFamily": 3,
      "textAlign": "center",
      "strokeColor": "#0c4a6e"
    },
    {
      "id": "followups-fields",
      "type": "text",
      "x": 560,
      "y": 760,
      "width": 180,
      "height": 90,
      "text": "ğŸ”‘ id: uuid (PK)\nğŸ”— lead_id: uuid (FK)\nğŸ”— org_id: uuid (FK, RLS)\nğŸ“… scheduled_at: timestamp\nğŸ“ notes: text\nâœ… completed: boolean",
      "fontSize": 12,
      "fontFamily": 3,
      "textAlign": "left",
      "strokeColor": "#0c4a6e"
    },
    {
      "id": "media-box",
      "type": "rectangle",
      "x": 50,
      "y": 720,
      "width": 200,
      "height": 140,
      "strokeColor": "#0284c7",
      "backgroundColor": "#e0f2fe",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3, "value": 8 }
    },
    {
      "id": "media-title",
      "type": "text",
      "x": 60,
      "y": 730,
      "width": 180,
      "height": 24,
      "text": "media_assets",
      "fontSize": 18,
      "fontFamily": 3,
      "textAlign": "center",
      "strokeColor": "#0c4a6e"
    },
    {
      "id": "media-fields",
      "type": "text",
      "x": 60,
      "y": 760,
      "width": 180,
      "height": 90,
      "text": "ğŸ”‘ id: uuid (PK)\nğŸ”— org_id: uuid (FK, RLS)\nğŸ—„ï¸ storage_key: varchar\nğŸ“ mime_type: varchar\nğŸ“ size_bytes: bigint\nğŸ“… uploaded_at: timestamp",
      "fontSize": 12,
      "fontFamily": 3,
      "textAlign": "left",
      "strokeColor": "#0c4a6e"
    },
    {
      "id": "notifications-box",
      "type": "rectangle",
      "x": 800,
      "y": 340,
      "width": 200,
      "height": 160,
      "strokeColor": "#a78bfa",
      "backgroundColor": "#faf5ff",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3, "value": 8 }
    },
    {
      "id": "notifications-title",
      "type": "text",
      "x": 810,
      "y": 350,
      "width": 180,
      "height": 24,
      "text": "notifications",
      "fontSize": 18,
      "fontFamily": 3,
      "textAlign": "center",
      "strokeColor": "#5b21b6"
    },
    {
      "id": "notifications-fields",
      "type": "text",
      "x": 810,
      "y": 380,
      "width": 180,
      "height": 110,
      "text": "ğŸ”‘ id: uuid (PK)\nğŸ”— user_id: uuid (FK)\nğŸ”— org_id: uuid (FK, RLS)\nğŸ“Œ type: varchar\nğŸ“ message: text\nğŸ‘ï¸ read_at: timestamp\nğŸ“… created_at: timestamp",
      "fontSize": 12,
      "fontFamily": 3,
      "textAlign": "left",
      "strokeColor": "#5b21b6"
    },
    {
      "id": "prefs-box",
      "type": "rectangle",
      "x": 800,
      "y": 540,
      "width": 200,
      "height": 140,
      "strokeColor": "#a78bfa",
      "backgroundColor": "#faf5ff",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3, "value": 8 }
    },
    {
      "id": "prefs-title",
      "type": "text",
      "x": 810,
      "y": 550,
      "width": 180,
      "height": 24,
      "text": "user_preferences",
      "fontSize": 18,
      "fontFamily": 3,
      "textAlign": "center",
      "strokeColor": "#5b21b6"
    },
    {
      "id": "prefs-fields",
      "type": "text",
      "x": 810,
      "y": 580,
      "width": 180,
      "height": 90,
      "text": "ğŸ”‘ id: uuid (PK)\nğŸ”— user_id: uuid (FK)\nğŸ”— org_id: uuid (FK, RLS)\nğŸ¤– autonomy_preset: enum\nğŸ”” notification_prefs: jsonb\nğŸ“… updated_at: timestamp",
      "fontSize": 12,
      "fontFamily": 3,
      "textAlign": "left",
      "strokeColor": "#5b21b6"
    },
    {
      "id": "arrow-user-member",
      "type": "arrow",
      "x": 150,
      "y": 280,
      "width": 100,
      "height": 40,
      "strokeColor": "#64748b",
      "strokeWidth": 2,
      "points": [[0, 0], [100, 40]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "arrow-org-member",
      "type": "arrow",
      "x": 450,
      "y": 280,
      "width": 100,
      "height": 40,
      "strokeColor": "#64748b",
      "strokeWidth": 2,
      "points": [[0, 0], [-100, 40]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "arrow-org-events",
      "type": "arrow",
      "x": 550,
      "y": 190,
      "width": 100,
      "height": 0,
      "strokeColor": "#64748b",
      "strokeWidth": 2,
      "points": [[0, 0], [100, 0]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "arrow-org-briefs",
      "type": "arrow",
      "x": 350,
      "y": 280,
      "width": 200,
      "height": 220,
      "strokeColor": "#64748b",
      "strokeWidth": 2,
      "points": [[0, 0], [-200, 220]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "arrow-org-sites",
      "type": "arrow",
      "x": 450,
      "y": 280,
      "width": 0,
      "height": 220,
      "strokeColor": "#64748b",
      "strokeWidth": 2,
      "points": [[0, 0], [0, 220]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "arrow-site-pages",
      "type": "arrow",
      "x": 400,
      "y": 660,
      "width": 0,
      "height": 40,
      "strokeColor": "#64748b",
      "strokeWidth": 2,
      "points": [[0, 0], [0, 40]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "arrow-org-leads",
      "type": "arrow",
      "x": 550,
      "y": 280,
      "width": 100,
      "height": 220,
      "strokeColor": "#64748b",
      "strokeWidth": 2,
      "points": [[0, 0], [100, 220]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "arrow-lead-followup",
      "type": "arrow",
      "x": 650,
      "y": 680,
      "width": 0,
      "height": 40,
      "strokeColor": "#64748b",
      "strokeWidth": 2,
      "points": [[0, 0], [0, 40]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "arrow-user-notif",
      "type": "arrow",
      "x": 250,
      "y": 190,
      "width": 550,
      "height": 170,
      "strokeColor": "#64748b",
      "strokeWidth": 2,
      "strokeStyle": "dashed",
      "points": [[0, 0], [550, 170]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "arrow-user-prefs",
      "type": "arrow",
      "x": 250,
      "y": 230,
      "width": 550,
      "height": 350,
      "strokeColor": "#64748b",
      "strokeWidth": 2,
      "strokeStyle": "dashed",
      "points": [[0, 0], [550, 350]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "legend-box",
      "type": "rectangle",
      "x": 50,
      "y": 900,
      "width": 950,
      "height": 80,
      "strokeColor": "#94a3b8",
      "backgroundColor": "#f8fafc",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roundness": { "type": 3, "value": 8 }
    },
    {
      "id": "legend-title",
      "type": "text",
      "x": 70,
      "y": 910,
      "width": 80,
      "height": 18,
      "text": "Legend:",
      "fontSize": 14,
      "fontFamily": 1,
      "strokeColor": "#1e293b"
    },
    {
      "id": "legend-db",
      "type": "rectangle",
      "x": 150,
      "y": 935,
      "width": 20,
      "height": 20,
      "strokeColor": "#7c3aed",
      "backgroundColor": "#ede9fe",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "legend-db-text",
      "type": "text",
      "x": 180,
      "y": 938,
      "width": 100,
      "height": 16,
      "text": "Identity Tables",
      "fontSize": 12,
      "fontFamily": 1,
      "strokeColor": "#1e293b"
    },
    {
      "id": "legend-domain",
      "type": "rectangle",
      "x": 310,
      "y": 935,
      "width": 20,
      "height": 20,
      "strokeColor": "#0284c7",
      "backgroundColor": "#e0f2fe",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "legend-domain-text",
      "type": "text",
      "x": 340,
      "y": 938,
      "width": 100,
      "height": 16,
      "text": "Domain Tables",
      "fontSize": 12,
      "fontFamily": 1,
      "strokeColor": "#1e293b"
    },
    {
      "id": "legend-event",
      "type": "rectangle",
      "x": 470,
      "y": 935,
      "width": 20,
      "height": 20,
      "strokeColor": "#f59e0b",
      "backgroundColor": "#fef3c7",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "legend-event-text",
      "type": "text",
      "x": 500,
      "y": 938,
      "width": 100,
      "height": 16,
      "text": "Event Store",
      "fontSize": 12,
      "fontFamily": 1,
      "strokeColor": "#1e293b"
    },
    {
      "id": "legend-user",
      "type": "rectangle",
      "x": 620,
      "y": 935,
      "width": 20,
      "height": 20,
      "strokeColor": "#a78bfa",
      "backgroundColor": "#faf5ff",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "legend-user-text",
      "type": "text",
      "x": 650,
      "y": 938,
      "width": 100,
      "height": 16,
      "text": "User Context",
      "fontSize": 12,
      "fontFamily": 1,
      "strokeColor": "#1e293b"
    },
    {
      "id": "legend-rls",
      "type": "text",
      "x": 780,
      "y": 938,
      "width": 200,
      "height": 16,
      "text": "ğŸ”— FK, RLS = Row-Level Security",
      "fontSize": 12,
      "fontFamily": 1,
      "strokeColor": "#1e293b"
    }
  ],
  "appState": {
    "viewBackgroundColor": "#ffffff",
    "gridSize": 20
  },
  "files": {}
}
