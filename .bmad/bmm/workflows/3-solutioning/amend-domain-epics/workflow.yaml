# Domain Epics Amendment Workflow
name: amend-domain-epics
description: "Amend Domain Epics document with impact analysis, maintaining inheritance alignment."
author: "BMad"

# Critical variables from config
config_source: "{project-root}/.bmad/bmm/config.yaml"
user_name: "{config_source}:user_name"
communication_language: "{config_source}:communication_language"
date: system-generated

# Federated hierarchy - determined at runtime
entity_type: "{entity_type}"
entity_type_display: "{entity_type_display}"
output_folder_resolved: "{output_folder_resolved}"
parent_epics_path: "{parent_epics_path}"
constitution_epics_path: "docs/platform/epics.md"

# Workflow components
installed_path: "{project-root}/.bmad/bmm/workflows/3-solutioning/amend-domain-epics"
instructions: "{installed_path}/instructions.md"

# Entity-specific checklists
checklist_infrastructure: "{project-root}/.bmad/bmm/checklists/infrastructure-epics-checklist.md"
checklist_strategic: "{project-root}/.bmad/bmm/checklists/strategic-epics-checklist.md"
checklist_coordination: "{project-root}/.bmad/bmm/checklists/coordination-epics-checklist.md"
checklist_business: "{project-root}/.bmad/bmm/checklists/business-epics-checklist.md"

# Shared tasks
detect_entity_task: "{project-root}/.bmad/bmm/tasks/detect-entity-type.xml"
impact_analysis_task: "{project-root}/.bmad/bmm/tasks/impact-analysis.xml"
validate_inheritance_task: "{project-root}/.bmad/bmm/tasks/validate-inheritance.xml"
save_task: "{project-root}/.bmad/bmm/tasks/save-with-checkpoint.xml"

# Input file patterns
input_file_patterns:
  current_epics:
    description: "Current Domain Epics"
    whole: "{output_folder_resolved}epics.md"
    load_strategy: "FULL_LOAD"

  entity_prd:
    description: "Entity PRD for context"
    whole: "{output_folder_resolved}prd.md"
    load_strategy: "FULL_LOAD"

  constitution_epics:
    description: "Constitution Epics for inheritance"
    whole: "{project-root}/docs/platform/epics.md"
    load_strategy: "FULL_LOAD"

  parent_epics:
    description: "Parent Epics for inheritance"
    whole: "{parent_epics_path}"
    load_strategy: "FULL_LOAD"

# Output files
default_output_file: "{output_folder_resolved}epics.md"

standalone: true
