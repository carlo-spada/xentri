---
import { auth } from '@clerk/astro/server';
import AppShell from '../layouts/AppShell.astro';
import { Hero } from '../components/Hero';
import { EventTimeline } from '../components/EventTimeline';

const { orgId } = await auth();
if (!orgId) {
  return Astro.redirect('/sign-in');
}
---

<AppShell title="Dashboard">
  <div class="dashboard-content">
    <Hero client:load />
    <!-- EventTimeline: Story 1.2 vertical slice - displays recent system events -->
    <EventTimeline
      client:only="react"
      apiUrl="http://localhost:3000"
      orgId={orgId}
      limit={10}
    />
  </div>
</AppShell>

<style>
  .dashboard-content {
    max-width: 960px;
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }
</style>
