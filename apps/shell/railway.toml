# Railway Config as Code
# Docs: https://docs.railway.app/reference/config-as-code
#
# This file ensures reproducible deployments - no clickops drift.
# All settings here override Railway dashboard configuration.

[build]
# CRITICAL: Use Dockerfile, not Nixpacks (per ADR-004)
builder = "dockerfile"
dockerfilePath = "Dockerfile"

[deploy]
# Health check - Astro serves on root
healthcheckPath = "/"
healthcheckTimeout = 30
numReplicas = 1

# Restart policy
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3

# Start command for Astro SSR
startCommand = "node ./dist/server/entry.mjs"

[deploy.environmentVariables]
# These are defaults/documentation - actual secrets set in Railway dashboard
# PORT = "4321"
# HOST = "0.0.0.0"
# NODE_ENV = "production"
